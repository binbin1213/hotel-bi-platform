### **智能化酒店业BI报告平台 (Hotel BI Platform)**

#### **1. 项目愿景与目标 (Project Vision & Goals)**

- **愿景**: 打造一个自动化、智能化、可视化的数据分析平台，将酒店从业者从每周重复性的报告工作中解放出来，让他们能更专注于数据背后的洞察和业务决策。

- 核心目标

  :

  1. **效率提升**: 实现从上传原始数据到生成专业报告的全流程自动化。
  2. **决策支持**: 通过AI智能分析，为管理层提供数据驱动的、可执行的建议。
  3. **专业呈现**: 生成两种格式的精美报告：用于正式汇报的**高保真PDF**和用于团队协作的**可编辑PPT**。

#### **2. 核心功能 (Core Features)**

1. **数据上传与管理**: 提供简洁的Web界面，支持拖拽上传标准格式的Excel数据文件。

2. **KPI自动计算**: 后端自动处理数据，计算核心经营指标（OCC, ADR, RevPAR等）。

3. **AI智能分析**: 对接DeepSeek等大语言模型，自动生成对当周业绩的分析、洞察和建议。

4. 双格式报告生成

   :

   - **PDF报告**: 基于HTML/CSS模板生成，视觉效果丰富、现代、“炫酷”，用于正式演示。
   - **PPT报告**: 基于预设的PowerPoint模板生成，格式标准，内容可被团队成员二次编辑。

5. **历史数据仪表盘**: 提供交互式仪表盘，用户可查看并对比历史各周期的经营数据和KPI趋势。

6. **用户权限管理**: (后期扩展) 支持多用户及不同权限级别的管理。

#### **3. 技术架构与选型 (Technical Architecture & Stack)**

我们将采用前后端分离的现代Web架构，并利用Docker进行容器化部署。

- 后端 (Backend)

  :

  - **语言/框架**: `Python 3.11+` / `FastAPI`
  - **数据处理**: `Pandas`
  - **数据库交互**: `SQLAlchemy` (ORM)
  - **PDF生成**: `Playwright` (通过驱动无头浏览器渲染HTML)
  - **PPT生成**: `python-pptx`
  - **HTML模板**: `Jinja2`
  - **AI调用**: `httpx`

- 前端 (Frontend)

  :

  - **框架**: `Vue 3` (使用 `Vite` 构建)
  - **UI库**: `Element Plus`
  - **图表库**: `Apache ECharts`
  - **API通信**: `Axios`

- 数据库 (Database)

  :

  - `PostgreSQL 15+`

- AI服务 (AI Service)

  :

  - `DeepSeek API` (或任何兼容的LLM API)

- 部署 (Deployment)

  :

  - `Docker` / `Docker Compose`

#### **4. 核心工作流详解 (Detailed Core Workflow)**

1. **上传数据**: 用户在**前端界面**上传Excel文件。

2. 处理与入库

   :

   - **后端API**接收文件。
   - `Pandas`服务读取文件，进行数据清洗、校验，并计算所有KPI。
   - `SQLAlchemy`服务将清洗后的原始数据和计算后的KPI数据存入**PostgreSQL数据库**。

3. AI分析

   :

   - 后端触发`AI分析服务`。
   - 从数据库中查询本周、上周及去年同期的KPI数据。
   - 构建一个结构化的、丰富的**Prompt**。
   - 通过`httpx`调用**DeepSeek API**，获取分析文本，并将其存入数据库。

4. 双格式报告生成

   : 当用户请求生成报告时，后端并行或串行启动两个生成器：

   - PDF生成器

     :

     1. `Jinja2`将所有数据（KPI、渠道占比、AI分析文本等）填充到一个精美的**HTML报告模板**中。
     2. `Playwright`启动无头浏览器加载此HTML页面。
     3. `ECharts`图表在页面中动态渲染。
     4. Playwright执行“打印”命令，生成一个视觉效果完美的高保真**PDF文件**。

   - PPT生成器

     :

     1. 加载一个预先设计好的**`.pptx`母版模板**。
     2. `python-pptx`将KPI数据填入表格，将AI分析文本填入文本框。
     3. `matplotlib`根据数据生成风格统一的**静态图表图片**。
     4. `python-pptx`将这些图表图片插入到PPT的指定位置，生成一个内容完整、可编辑的**PPT文件**。

5. 下载与展示

   :

   - 后端将生成好的PDF和PPT文件的下载链接返回给**前端**。
   - 前端界面上提供两个清晰的下载按钮：“下载汇报版 (PDF)”和“下载编辑版 (PPT)”。
   - 同时，仪表盘页面通过API获取数据，用`ECharts`动态展示历史趋势。

#### **5. 项目实施路线图 (Project Implementation Roadmap)**

建议采用敏捷开发的思路，分阶段交付，快速验证核心价值。

- 第一阶段：核心后端与数据处理 (约2-3周)
  - **目标**: 搭建好数据库和后端服务，实现数据上传、处理和存储。
  - **产出**: 可以通过API接口上传Excel，数据能被正确处理并存入数据库。无需UI。
- 第二阶段：基础报告生成与前端MVP (约3-4周)
  - **目标**: 实现核心的PDF和PPT报告生成功能，并开发一个最小可用的前端界面。
  - **产出**: 用户可以上传文件，并能下载到两个格式的、包含基础数据的报告。系统具备核心价值。
- 第三阶段：集成AI分析与仪表盘 (约2-3周)
  - **目标**: 对接DeepSeek API，并将AI分析内容整合进报告和前端页面。开发历史数据仪表盘。
  - **产出**: 报告具备“智能”，用户可以直观地看到历史数据趋势，平台价值大幅提升。
- 第四阶段：优化与扩展 (持续进行)
  - **目标**: 根据用户反馈进行优化，并增加用户管理、权限控制等高级功能。
  - **产出**: 一个功能完善、体验流畅、稳定可靠的BI平台。

#### **6. 预期成果与价值 (Expected Outcomes & Value)**

- **时间成本**: 每周节省2-4小时的手动报告制作时间。
- **数据质量**: 确保数据口径统一，计算准确，避免人为错误。
- **决策质量**: AI洞察帮助管理者发现手动分析时可能忽略的问题和机会。
- **品牌形象**: 专业、精美的报告提升了团队和酒店的专业形象。